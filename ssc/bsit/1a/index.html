<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BSIT 1A</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f9fafb;
      color: #1e293b;
      margin: 0;
      padding: 20px;
    }
    header {
      text-align: center;
      margin-bottom: 20px;
    }
    h1 {
      color: #9333ea;
    }
    .toggle-btn {
      display: block;
      margin: 10px auto 20px;
      padding: 10px 20px;
      background: #9333ea;
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: 0.2s;
    }
    .toggle-btn:hover {
      background: #7e22ce;
    }
    .table-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      max-width: 1000px;
      margin: 0 auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      border-radius: 8px;
      overflow: hidden;
    }
    td {
      padding: 8px 12px;
      border-bottom: 1px solid #e2e8f0;
      font-size: 0.95rem;
    }
    tr:last-child td {
      border-bottom: none;
    }
    a {
      text-decoration: none;
      color: #2563eb;
      font-weight: bold;
    }
    small {
      color: #64748b;
      font-size: 0.8rem;
    }
    .today { color: #16a34a; font-weight: bold; }
    .upcoming { color: #dc2626; font-style: italic; }

    footer {
      margin-top: 20px;
      text-align: center;
      font-size: 0.9rem;
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }
    .month-card {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      padding: 15px;
    }
    .month-card h2 {
      margin-top: 0;
      font-size: 1.2rem;
      color: #2563eb;
      text-align: center;
    }
    ul { list-style: none; padding: 0; margin: 0; }
    li { margin-bottom: 8px; font-size: 0.95rem; }
    a:hover { text-decoration: underline; }
    .highlight { background: #f0f9ff; border: 2px solid #38bdf8; }
    .nobday { color: #94a3b8; font-size: 0.9rem; font-style: italic; }

    #classView, #calendarView { display: none; }
    #classView.active, #calendarView.active { display: block; }
  </style>
</head>
<body>
  <header>
    <h1>BSIT 1A</h1>
    <h3>Siquijor State College</h3>
  </header>

  <button class="toggle-btn" onclick="toggleView()">Switch to Birthday Calendar</button>

  <div id="classView" class="active">
    <div class="table-container" id="classTable"></div>
    <footer>
      <strong>Upcoming Birthdays:</strong>
      <div id="birthdayList">No birthdays today or soon.</div>
    </footer>
  </div>

  <div id="calendarView">
    <div class="calendar" id="calendar"></div>
  </div>

  <script>
    let showingClassList = true;

    function toggleView() {
      showingClassList = !showingClassList;
      document.getElementById("classView").classList.toggle("active", showingClassList);
      document.getElementById("calendarView").classList.toggle("active", !showingClassList);
      document.querySelector(".toggle-btn").innerText =
        showingClassList ? "Switch to Birthday Calendar" : "Switch to Class List";
    }

    const months = [
      "January","February","March","April","May","June",
      "July","August","September","October","November","December"
    ];

    async function loadData() {
      const res = await fetch("names.txt");
      const text = await res.text();
      const lines = text.trim().split("\n");

      const today = new Date();
      const todayMonth = today.getMonth() + 1;
      const todayDay = today.getDate();

      let leftCol = "<table>", rightCol = "<table>";
      let birthdays = [];
      let birthdayData = {};
      months.forEach((m, i) => { birthdayData[i+1] = []; });

      lines.forEach((line, idx) => {
        const parts = line.split("=").map(s => s.trim());
        const name = parts[0] || "Unknown";
        const link = parts[1] || "#";
        const bday = parts[2] || "No data";

        let birthdayNote = "";
        if (bday !== "No data") {
          const [mm, dd] = bday.split("/").map(n => parseInt(n));
          if (!isNaN(mm) && !isNaN(dd)) {
            if (mm === todayMonth && dd === todayDay) {
              birthdayNote = `<span class="today"> ( Today!)</span>`;
              birthdays.push(`${name} —  Today!`);
            } else {
              let thisYear = new Date(today.getFullYear(), mm - 1, dd);
              const diff = (thisYear - today) / (1000 * 60 * 60 * 24);
              if (diff > 0 && diff <= 14) {
                birthdayNote = `<span class="upcoming"> ( Coming: ${bday})</span>`;
                birthdays.push(`${name} —  Coming on ${bday}`);
              }
            }
            birthdayData[mm].push({ name, link, day: dd, year: bday.split("/")[2] });
          }
        }

        const row = `<tr>
          <td>${idx+1}.</td>
          <td><a href="${link}" target="_blank">${name}</a><br><small>${bday}${birthdayNote}</small></td>
        </tr>`;

        if (idx < lines.length/2) leftCol += row; else rightCol += row;
      });

      leftCol += "</table>"; rightCol += "</table>";
      document.getElementById("classTable").innerHTML = leftCol + rightCol;
      document.getElementById("birthdayList").innerHTML = birthdays.length ? birthdays.join("<br>") : "No birthdays today or soon.";

      let html = "";
      months.forEach((m, i) => {
        const entries = birthdayData[i+1];
        entries.sort((a,b) => a.day - b.day);

        html += `<div class="month-card ${i+1 === todayMonth ? "highlight" : ""}">
          <h2>${m}</h2><ul>`;

        if (entries.length === 0) {
          html += `<li class="nobday">No birthdays</li>`;
        } else {
          entries.forEach(e => {
            html += `<li><strong>${e.day}</strong> — <a href="${e.link}" target="_blank">${e.name}</a> <small>(${e.year})</small></li>`;
          });
        }
        html += `</ul></div>`;
      });
      document.getElementById("calendar").innerHTML = html;
    }

    loadData();
  </script>
</body>
</html>